%%
clear; clc;
A = [0 0 0 0 0 0 0 1;
    0 0 0 0 0 0 1 0;
    0 0 0 0 0 1 0 0;
    0 0 0 0 1 0 0 0;
    1 1 1 1 1 1 1 1;
    7 6 5 4 3 2 1 0;
    42 30 20 12 6 2 0 0;
    210 120 60 24 6 0 0 0];
% B1 = [0 0 0;30 0 0;0 0 0;0 0 0;4 40 20;-20 10 5;0 0 0;0 0 0];
B1 = [0 0 0;5 0 0;0 0 0;0 0 0;10 0 -8;5 0 0;0 0 0;0 0 0];
alp = A\B1;
tau = 0:0.01:1;k = 1;
for tau = 0:0.01:1
    x(k) = alp(1,1)*tau^7 + alp(2,1)*tau^6 + alp(3,1)*tau^5 ...
        + alp(4,1)*tau^4 + alp(5,1)*tau^3 + alp(6,1)*tau^2 ...
        + alp(7,1)*tau + alp(8,1);
    xd(k) = 7*alp(1,1)*tau^6 + 6*alp(2,1)*tau^5 + 5*alp(3,1)*tau^4 ...
        + 4*alp(4,1)*tau^3 + 3*alp(5,1)*tau^2 + 2*alp(6,1)*tau ...
        + alp(7,1);
    xdd(k) = 42*alp(1,1)*tau^5 + 30*alp(2,1)*tau^4 + 20*alp(3,1)*tau^3 ...
        + 12*alp(4,1)*tau^2 + 6*alp(5,1)*tau + 2*alp(6,1);
    xddd(k) = 210*alp(1,1)*tau^4 + 120*alp(2,1)*tau^3 + 60*alp(3,1)*tau^2 ...
        + 24*alp(4,1)*tau + 6*alp(5,1);
    y(k) = alp(1,2)*tau^7 + alp(2,2)*tau^6 + alp(3,2)*tau^5 ...
        + alp(4,2)*tau^4 + alp(5,2)*tau^3 + alp(6,2)*tau^2 ...
        + alp(7,2)*tau + alp(8,2);
    yd(k) = 7*alp(1,2)*tau^6 + 6*alp(2,2)*tau^5 + 5*alp(3,2)*tau^4 ...
        + 4*alp(4,2)*tau^3 + 3*alp(5,2)*tau^2 + 2*alp(6,2)*tau ...
        + alp(7,2);
    ydd(k) = 42*alp(1,2)*tau^5 + 30*alp(2,2)*tau^4 + 20*alp(3,2)*tau^3 ...
        + 12*alp(4,2)*tau^2 + 6*alp(5,2)*tau + 2*alp(6,2);
    yddd(k) = 210*alp(1,2)*tau^4 + 120*alp(2,2)*tau^3 + 60*alp(3,2)*tau^2 ...
        + 24*alp(4,2)*tau + 6*alp(5,2);
    z(k) = alp(1,3)*tau^7 + alp(2,3)*tau^6 + alp(3,3)*tau^5 ...
        + alp(4,3)*tau^4 + alp(5,3)*tau^3 + alp(6,3)*tau^2 ...
        + alp(7,3)*tau + alp(8,3);
    zd(k) = 7*alp(1,3)*tau^6 + 6*alp(2,3)*tau^5 + 5*alp(3,3)*tau^4 ...
        + 4*alp(4,3)*tau^3 + 3*alp(5,3)*tau^2 + 2*alp(6,3)*tau ...
        + alp(7,3);
    zdd(k) = 42*alp(1,3)*tau^5 + 30*alp(2,3)*tau^4 + 20*alp(3,3)*tau^3 ...
        + 12*alp(4,3)*tau^2 + 6*alp(5,3)*tau + 2*alp(6,3);
    zddd(k) = 210*alp(1,3)*tau^4 + 120*alp(2,3)*tau^3 + 60*alp(3,3)*tau^2 ...
        + 24*alp(4,3)*tau + 6*alp(5,3);
    k = k+1;
end
% k = k-1;
% B2 = [4 40 20;-20 10 5;0 0 0;0 0 0;15 70 0;20 -20 0;0 0 0;0 0 0];
% alp = A\B2;
% for tau = 0:0.01:1
%     x(k) = alp(1,1)*tau^7 + alp(2,1)*tau^6 + alp(3,1)*tau^5 ...
%         + alp(4,1)*tau^4 + alp(5,1)*tau^3 + alp(6,1)*tau^2 ...
%         + alp(7,1)*tau + alp(8,1);
%     xd(k) = 7*alp(1,1)*tau^6 + 6*alp(2,1)*tau^5 + 5*alp(3,1)*tau^4 ...
%         + 4*alp(4,1)*tau^3 + 3*alp(5,1)*tau^2 + 2*alp(6,1)*tau ...
%         + alp(7,1);
%     xdd(k) = 42*alp(1,1)*tau^5 + 30*alp(2,1)*tau^4 + 20*alp(3,1)*tau^3 ...
%         + 12*alp(4,1)*tau^2 + 6*alp(5,1)*tau + 2*alp(6,1);
%     xddd(k) = 210*alp(1,1)*tau^4 + 120*alp(2,1)*tau^3 + 60*alp(3,1)*tau^2 ...
%         + 24*alp(4,1)*tau + 6*alp(5,1);
%     y(k) = alp(1,2)*tau^7 + alp(2,2)*tau^6 + alp(3,2)*tau^5 ...
%         + alp(4,2)*tau^4 + alp(5,2)*tau^3 + alp(6,2)*tau^2 ...
%         + alp(7,2)*tau + alp(8,2);
%     yd(k) = 7*alp(1,2)*tau^6 + 6*alp(2,2)*tau^5 + 5*alp(3,2)*tau^4 ...
%         + 4*alp(4,2)*tau^3 + 3*alp(5,2)*tau^2 + 2*alp(6,2)*tau ...
%         + alp(7,2);
%     ydd(k) = 42*alp(1,2)*tau^5 + 30*alp(2,2)*tau^4 + 20*alp(3,2)*tau^3 ...
%         + 12*alp(4,2)*tau^2 + 6*alp(5,2)*tau + 2*alp(6,2);
%     yddd(k) = 210*alp(1,2)*tau^4 + 120*alp(2,2)*tau^3 + 60*alp(3,2)*tau^2 ...
%         + 24*alp(4,2)*tau + 6*alp(5,2);
%     z(k) = alp(1,3)*tau^7 + alp(2,3)*tau^6 + alp(3,3)*tau^5 ...
%         + alp(4,3)*tau^4 + alp(5,3)*tau^3 + alp(6,3)*tau^2 ...
%         + alp(7,3)*tau + alp(8,3);
%     zd(k) = 7*alp(1,3)*tau^6 + 6*alp(2,3)*tau^5 + 5*alp(3,3)*tau^4 ...
%         + 4*alp(4,3)*tau^3 + 3*alp(5,3)*tau^2 + 2*alp(6,3)*tau ...
%         + alp(7,3);
%     zdd(k) = 42*alp(1,3)*tau^5 + 30*alp(2,3)*tau^4 + 20*alp(3,3)*tau^3 ...
%         + 12*alp(4,3)*tau^2 + 6*alp(5,3)*tau + 2*alp(6,3);
%     zddd(k) = 210*alp(1,3)*tau^4 + 120*alp(2,3)*tau^3 + 60*alp(3,3)*tau^2 ...
%         + 24*alp(4,3)*tau + 6*alp(5,3);
%     k = k+1;
% end
figure;
plot3(y,x,z); grid; xlabel('east');ylabel('north');zlabel('altitude');
figure;
plot(x);hold on;
plot(y,'r');
plot(z,'g'); hold off;
grid; 
figure;
plot(xd);hold on;
plot(yd,'r');
plot(zd,'g'); hold off;
grid; 
figure;
plot(xdd);hold on;
plot(ydd,'r');
plot(zdd,'g'); hold off;
grid; 
% figure(3);
% psi = atan2(yd,xd);
% plot(psi);